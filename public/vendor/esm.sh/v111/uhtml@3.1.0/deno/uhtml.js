/* esm.sh - esbuild bundle(uhtml@3.1.0) deno production */
import{MapSet as et,WeakMapSet as S}from"/v111/@webreflection/mapset@1.0.1/deno/mapset.js";import{WeakMapSet as K}from"/v111/@webreflection/mapset@1.0.1/deno/mapset.js";import Q from"/v111/@webreflection/uparser@0.2.4/deno/uparser.js";import{persistent as X}from"/v111/@webreflection/uwire@1.2.1/deno/uwire.js";import{diffable as F}from"/v111/@webreflection/uwire@1.2.1/deno/uwire.js";import{aria as G,attribute as R,boolean as U,event as A,ref as _,setter as q,text as w}from"/v111/uhandlers@0.7.0/deno/uhandlers.js";import z from"/v111/udomdiff@1.1.0/deno/udomdiff.js";var{isArray:g,prototype:L}=Array,{indexOf:b}=L;var{createDocumentFragment:W,createElement:j,createElementNS:H,createTextNode:N,createTreeWalker:T,importNode:$}=new Proxy(document,{get:(t,e)=>t[e].bind(t)});var P=t=>{let e=j("template");return e.innerHTML=t,e.content},m,D=t=>{m||(m=H("http://www.w3.org/2000/svg","svg")),m.innerHTML=t;let e=W();return e.append(...m.childNodes),e},v=(t,e)=>e?D(t):P(t);var B=({childNodes:t},e)=>t[e],h=(t,e,o)=>z(t.parentNode,e,o,F,t),I=t=>{let e,o,r=[],s=n=>{switch(typeof n){case"string":case"number":case"boolean":e!==n&&(e=n,o||(o=N("")),o.data=n,r=h(t,r,[o]));break;case"object":case"undefined":if(n==null){e!=n&&(e=n,r=h(t,r,[]));break}if(g(n)){e=n,n.length===0?r=h(t,r,[]):typeof n[0]=="object"?r=h(t,r,n):s(String(n));break}if(e!==n)if("ELEMENT_NODE"in n)e=n,r=h(t,r,n.nodeType===11?[...n.childNodes]:[n]);else{let a=n.valueOf();a!==n&&s(a)}break;case"function":s(n(t));break}};return s},J=(t,e)=>{switch(e[0]){case"?":return U(t,e.slice(1),!1);case".":return q(t,e.slice(1));case"@":return A(t,"on"+e.slice(1));case"o":if(e[1]==="n")return A(t,e)}switch(e){case"ref":return _(t);case"aria":return G(t)}return R(t,e)};function C(t){let{type:e,path:o}=t,r=o.reduceRight(B,this);return e==="node"?I(r):e==="attr"?J(r,t.name):w(r)}var y=t=>{let e=[],{parentNode:o}=t;for(;o;)e.push(b.call(o.childNodes,t)),t=o,{parentNode:o}=t;return e},d="is\xB5",O=new K,Y=/^(?:textarea|script|style|title|plaintext|xmp)$/,l=()=>({stack:[],entry:null,wire:null}),Z=(t,e)=>{let{content:o,updates:r}=tt(t,e);return{type:t,template:e,content:o,updates:r,wire:null}},V=(t,e)=>{let o=t==="svg",r=Q(e,d,o),s=v(r,o),n=T(s,129),a=[],x=e.length-1,p=0,c=`${d}${p}`;for(;p<x;){let i=n.nextNode();if(!i)throw`bad template: ${r}`;if(i.nodeType===8)i.data===c&&(a.push({type:"node",path:y(i)}),c=`${d}${++p}`);else{for(;i.hasAttribute(c);)a.push({type:"attr",path:y(i),name:i.getAttribute(c)}),i.removeAttribute(c),c=`${d}${++p}`;Y.test(i.localName)&&i.textContent.trim()===`<!--${c}-->`&&(i.textContent="",a.push({type:"text",path:y(i)}),c=`${d}${++p}`)}}return{content:s,nodes:a}},tt=(t,e)=>{let{content:o,nodes:r}=O.get(e)||O.set(e,V(t,e)),s=$(o,!0),n=r.map(C,s);return{content:s,updates:n}},u=(t,{type:e,template:o,values:r})=>{let s=E(t,r),{entry:n}=t;(!n||n.template!==o||n.type!==e)&&(t.entry=n=Z(e,o));let{content:a,updates:x,wire:p}=n;for(let c=0;c<s;c++)x[c](r[c]);return p||(n.wire=X(a))},E=({stack:t},e)=>{let{length:o}=e;for(let r=0;r<o;r++){let s=e[r];s instanceof f?e[r]=u(t[r]||(t[r]=l()),s):g(s)?E(t[r]||(t[r]=l()),s):t[r]=null}return o<t.length&&t.splice(o),o},f=class{constructor(e,o,r){this.type=e,this.template=o,this.values=r}};var k=t=>{let e=new S,o=r=>(s,...n)=>u(r,{type:t,template:s,values:n});return Object.assign((r,...s)=>new f(t,r,s),{for(r,s){let n=e.get(r)||e.set(r,new et);return n.get(s)||n.set(s,o(l()))},node:(r,...s)=>u(l(),new f(t,r,s)).valueOf()})},M=new S,gt=(t,e)=>{let o=typeof e=="function"?e():e,r=M.get(t)||M.set(t,l()),s=o instanceof f?u(r,o):o;return s!==r.wire&&(r.wire=s,t.replaceChildren(s.valueOf())),t},xt=k("html"),yt=k("svg");export{f as Hole,xt as html,gt as render,yt as svg};
//# sourceMappingURL=uhtml.js.map